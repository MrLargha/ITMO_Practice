### Плохой Dockerfile

```dockerfile
FROM ubuntu:latest

RUN apt-get update && \
    apt-get install -y nginx

COPY . /usr/share/nginx/html

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### Хороший Dockerfile

```dockerfile
# Используем минимальный образ Alpine Linux для уменьшения размера
FROM nginx:1.27-alpine

# Копируем статические файлы сайта
COPY ./src /usr/share/nginx/html

# Открываем порт 80 (не будем усложнять настройкой ssl)
EXPOSE 80

# Запускаем Nginx
CMD ["nginx", "-g", "daemon off;"]
```

---

## Описание плохих практик в плохом Dockerfile:

### 1. Использование образа `ubuntu:latest`

**Почему это плохо?**
Использование тегов вроде `latest` делает ваш Dockerfile ненадежным и непредсказуемым. Каждый раз при сборке может использоваться новая версия Ubuntu, что приведет к изменению зависимостей и поведения приложения.

**Как было исправлено?**
Bспользуем официальный образ `nginx:1.27-alpine`, который уже содержит Nginx и основан на легковесном дистрибутиве Alpine Linux, также явно укажем версию чтобы избежать возможных проблем при обновлении.

### 2. Установка Nginx через пакетный менеджер

**Почему это плохо?**
Установка Nginx вручную через пакетный менеджер (например, `apt-get`) усложняет образ и увеличивает его размер. Также это усложняет управление зависимостями и обновлениями и повышает время развертывания. 

**Как было исправлено?**
Как было сказано выше, используем готовый образ с Nginx.

### 3. Копирование всего проекта без разделения слоев

**Почему это плохо?**
Копирование всех файлов проекта сразу создает большой слой, который сложно кэшировать и обновлять. При каждом изменении любого файла придется пересобирать все, что замедлит процесс сборки.

**Как было исправлено?**
В хорошем Dockerfile копируются только src-файлы в соответствующую директорию Nginx. Это позволяет минимизировать объем копируемых данных и ускорить процесс сборки. Тяжелые медиа-ресурсы должны быть отправлены на отдельный cdn

**Результат исправления:**
Сборка стала быстрее, а также уменьшен объем копируемых данных.

---

## Плохие практики по работе с контейнерами:

### 1. Неправильное управление данными
Часто пользователи хранят важные данные прямо внутри контейнера, что приводит к их утрате при удалении контейнера. Контейнер предназначен для временного использования, поэтому данные нужно хранить отдельно. Для сохранения данных рекомендуется использовать внешние тома (volumes) или bind mounts. Это позволит сохранить данные независимо от жизненного цикла контейнера. Например:

```bash
docker run -d -v /path/to/data:/var/www/html my-nginx
```

### 2. Отсутствие мониторинга и логирования
При работе с контейнерами важно следить за их состоянием и производительностью. Без мониторинга и логирования трудно понять, что происходит внутри контейнера, и оперативно реагировать на возникающие проблемы.
Можно использоват такие инструменты, как Prometheus для мониторинга метрик, и ELK Stack (Elasticsearch, Logstash, Kibana) для сбора и анализа логов. Как минимум можно натстроить вывод логов в файл:

```bash
docker run -d --log-driver=json-file --log-opt max-size=10m --log-opt max-file=3 my-nginx
```
